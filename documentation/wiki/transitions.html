
<h1 class="sectionedit1" id="feathers_screennavigator_transitions">Feathers ScreenNavigator Transitions</h1>
<div class="level1">

<p>
Let&#039;s look at some advanced tips for using transitions with the <code><a href="/feathers/screen-navigator" class="wikilink1" title="feathers:screen-navigator">ScreenNavigator</a></code> class. We&#039;ll look at transitions from a low-level perspective to see how transition managers communicate with a screen navigator and how they abstract it. We&#039;ll also spend some time on optimization.
</p>

<p>
<p><div class="noteclassic">
For an introduction to transition managers, and transition events, see the <a href="/feathers/screen-navigator" class="wikilink1" title="feathers:screen-navigator">ScreenNavigator tutorial</a>.

</div></p>
</p>

</div>
<!-- EDIT1 SECTION "Feathers ScreenNavigator Transitions" [1-495] -->
<h2 class="sectionedit2" id="transitions_without_managers">Transitions without Managers</h2>
<div class="level2">

<p>
The <code><a href="http://feathersui.com/documentation/feathers/controls/ScreenNavigator.html#transition" class="urlextern" title="http://feathersui.com/documentation/feathers/controls/ScreenNavigator.html#transition"  rel="nofollow">transition</a></code> property on <code>ScreenNavigator</code> is simply typed as <code>Function</code>. Transition managers may do extra things like keep track of state, and manage tweens, and other things like, but ultimately, a manager passes a transition function to the <code>ScreenNavigator</code>. Let&#039;s take a look at the function signature and what the arguments do:
</p>
<pre class="code as3"><span class="kw3">function</span><span class="br0">&#40;</span> oldScreen<span class="sy0">:</span><a href="http://www.google.com/search?q=displayobject%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:displayobject.html"><span class="kw5">DisplayObject</span></a><span class="sy0">,</span> newScreen<span class="sy0">:</span><a href="http://www.google.com/search?q=displayobject%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:displayobject.html"><span class="kw5">DisplayObject</span></a><span class="sy0">,</span> completeCallback<span class="sy0">:</span><a href="http://www.google.com/search?q=function%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:function.html"><span class="kw5">Function</span></a> <span class="br0">&#41;</span><span class="sy0">:</span><span class="kw1">void</span></pre>

<p>
The transition function will receive the old screen that is transitioning out, the new screen that is transitioning in, and a function that needs to be called when the transition finishes.
</p>

<p>
There will always be at least one screen in the transition. However, the other screen may be null. For instance, when the first screen is shown by the screen navigator, the old screen will be <code>null</code> because no other screen has been shown. Similarly, if <code><a href="http://feathersui.com/documentation/feathers/controls/ScreenNavigator.html#clearScreen()" class="urlextern" title="http://feathersui.com/documentation/feathers/controls/ScreenNavigator.html#clearScreen()"  rel="nofollow">clearScreen()</a></code> is called on the screen navigator, the new screen will be <code>null</code> because there will be no new screen. There will never be a case where both screens are <code>null</code>.
</p>

<p>
The <code>completeCallback</code> references a function that should be called when your animation and other actions in the transition are finished. It may be saved in a variable somewhere if your transition takes time and won&#039;t be finished by the time the transition function returns. The <code>completeCallback</code> has the following signature:
</p>
<pre class="code as3"><span class="kw3">function</span> completeCallback<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw1">void</span></pre>

</div>
<!-- EDIT2 SECTION "Transitions without Managers" [496-2192] -->
<h3 class="sectionedit3" id="an_empty_transition">An Empty Transition</h3>
<div class="level3">

<p>
The simplest transition function is one that does nothing except call the <code>completeCallback</code> to say that the transition has finished immediately:
</p>
<pre class="code as3">navigator<span class="sy0">.</span>transition = <span class="kw3">function</span><span class="br0">&#40;</span> oldScreen<span class="sy0">:</span><a href="http://www.google.com/search?q=displayobject%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:displayobject.html"><span class="kw5">DisplayObject</span></a><span class="sy0">,</span> newScreen<span class="sy0">:</span><a href="http://www.google.com/search?q=displayobject%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:displayobject.html"><span class="kw5">DisplayObject</span></a><span class="sy0">,</span> completeCallback<span class="sy0">:</span><a href="http://www.google.com/search?q=function%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:function.html"><span class="kw5">Function</span></a> <span class="br0">&#41;</span><span class="sy0">:</span><span class="kw1">void</span>
<span class="br0">&#123;</span>
    completeCallback<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="sy0">;</span></pre>

</div>
<!-- EDIT3 SECTION "An Empty Transition" [2193-2537] -->
<h2 class="sectionedit4" id="a_simple_transition_manager">A Simple Transition Manager</h2>
<div class="level2">

<p>
Transition <em>managers</em> aren&#039;t based on a strict interface. Consider their design a useful suggestion for abstracting away details of how a transition works.
</p>

<p>
Let&#039;s create a class that always slides in new screens from the right side of the screen navigator with a tween. It doesn&#039;t track history or anything fancy or allow the animation to slide in screens from other directions. It&#039;s just a simple example that shows how to use a tween or other timed action and correctly report back to the screen navigator when it finishes.
</p>
<pre class="code as3"><span class="kw4">package</span>
<span class="br0">&#123;</span>
	<span class="kw1">import</span> feathers<span class="sy0">.</span>controls<span class="sy0">.</span>ScreenNavigator<span class="sy0">;</span>
&nbsp;
	<span class="kw1">import</span> starling<span class="sy0">.</span>animation<span class="sy0">.</span>Transitions<span class="sy0">;</span>
	<span class="kw1">import</span> starling<span class="sy0">.</span>animation<span class="sy0">.</span>Tween<span class="sy0">;</span>
	<span class="kw1">import</span> starling<span class="sy0">.</span>core<span class="sy0">.</span>Starling<span class="sy0">;</span>
	<span class="kw1">import</span> starling<span class="sy0">.</span>display<span class="sy0">.</span><a href="http://www.google.com/search?q=displayobject%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:displayobject.html"><span class="kw5">DisplayObject</span></a><span class="sy0">;</span>
&nbsp;
	<span class="kw1">public</span> <span class="kw4">class</span> SimpleTransitionManager
	<span class="br0">&#123;</span>
		<span class="kw1">public</span> <span class="kw3">function</span> ScreenSlidingStackTransitionManager<span class="br0">&#40;</span>navigator<span class="sy0">:</span>ScreenNavigator<span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="co1">//we'll need its dimensions later</span>
			<span class="kw1">this</span><span class="sy0">.</span>navigator = navigator<span class="sy0">;</span>
&nbsp;
			<span class="co1">//our onTransition function is what the navigator calls</span>
			<span class="co1">//to start the transition</span>
			<span class="kw1">this</span><span class="sy0">.</span>navigator<span class="sy0">.</span>transition = <span class="kw1">this</span><span class="sy0">.</span>onTransition<span class="sy0">;</span>
		<span class="br0">&#125;</span>
&nbsp;
		<span class="kw1">protected</span> <span class="kw2">var</span> navigator<span class="sy0">:</span>ScreenNavigator<span class="sy0">;</span>
		<span class="kw1">protected</span> <span class="kw2">var</span> tween<span class="sy0">:</span>Tween<span class="sy0">;</span>
		<span class="kw1">protected</span> <span class="kw2">var</span> savedOldScreen<span class="sy0">:</span><a href="http://www.google.com/search?q=displayobject%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:displayobject.html"><span class="kw5">DisplayObject</span></a><span class="sy0">;</span>
		<span class="kw1">protected</span> <span class="kw2">var</span> savedCompleteCallback<span class="sy0">:</span><a href="http://www.google.com/search?q=function%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:function.html"><span class="kw5">Function</span></a><span class="sy0">;</span>
&nbsp;
		<span class="kw1">protected</span> <span class="kw3">function</span> onTransition<span class="br0">&#40;</span>oldScreen<span class="sy0">:</span><a href="http://www.google.com/search?q=displayobject%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:displayobject.html"><span class="kw5">DisplayObject</span></a><span class="sy0">,</span> newScreen<span class="sy0">:</span><a href="http://www.google.com/search?q=displayobject%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:displayobject.html"><span class="kw5">DisplayObject</span></a><span class="sy0">,</span> completeCallback<span class="sy0">:</span><a href="http://www.google.com/search?q=function%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:function.html"><span class="kw5">Function</span></a><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw1">void</span>
		<span class="br0">&#123;</span>
			<span class="co1">//if we're already transitioning, stop immediately</span>
			<span class="kw1">if</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="sy0">.</span>tween<span class="br0">&#41;</span>
			<span class="br0">&#123;</span>
				<span class="kw1">this</span><span class="sy0">.</span>savedOldScreen = <span class="kw1">null</span><span class="sy0">;</span>
				<span class="kw1">this</span><span class="sy0">.</span>savedCompleteCallback = <span class="kw1">null</span><span class="sy0">;</span>
				Starling<span class="sy0">.</span>juggler<span class="sy0">.</span>remove<span class="br0">&#40;</span><span class="kw1">this</span><span class="sy0">.</span>tween<span class="br0">&#41;</span><span class="sy0">;</span>
				<span class="kw1">this</span><span class="sy0">.</span>tween = <span class="kw1">null</span><span class="sy0">;</span>
			<span class="br0">&#125;</span>
&nbsp;
			<span class="co1">//no need to animate if one of the screens is missing</span>
			<span class="kw1">if</span><span class="br0">&#40;</span><span class="sy0">!</span>oldScreen <span class="sy0">||</span> <span class="sy0">!</span>newScreen<span class="br0">&#41;</span>
			<span class="br0">&#123;</span>
				<span class="co1">//make sure the screen that exists is at the right position</span>
				<span class="kw1">if</span><span class="br0">&#40;</span>newScreen<span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					newScreen<span class="sy0">.</span><span class="kw7">x</span> = <span class="nu0">0</span><span class="sy0">;</span>
				<span class="br0">&#125;</span>
				<span class="kw1">if</span><span class="br0">&#40;</span>oldScreen<span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					oldScreen<span class="sy0">.</span><span class="kw7">x</span> = <span class="nu0">0</span><span class="sy0">;</span>
				<span class="br0">&#125;</span>
&nbsp;
				<span class="co1">//no animation, so let's finish immediately</span>
				completeCallback<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
				<span class="kw1">return</span><span class="sy0">;</span>
			<span class="br0">&#125;</span>
&nbsp;
			<span class="co1">//save this until the tween finishes</span>
			<span class="kw1">this</span><span class="sy0">.</span>savedCompleteCallback = completeCallback<span class="sy0">;</span>
&nbsp;
			<span class="co1">//save this so that we can use it in the onUpdate callback</span>
			<span class="kw1">this</span><span class="sy0">.</span>savedOldScreen = oldScreen<span class="sy0">;</span>
&nbsp;
			<span class="co1">//the old screen is on the left</span>
			oldScreen<span class="sy0">.</span><span class="kw7">x</span> = <span class="nu0">0</span><span class="sy0">;</span>
			<span class="co1">//the new screen is on the right</span>
			newScreen<span class="sy0">.</span><span class="kw7">x</span> = <span class="kw1">this</span><span class="sy0">.</span>navigator<span class="sy0">.</span><span class="kw7">width</span><span class="sy0">;</span>
&nbsp;
			<span class="co1">//animate the new screen to x == 0</span>
			<span class="kw1">this</span><span class="sy0">.</span>tween = <span class="kw1">new</span> Tween<span class="br0">&#40;</span>newScreen<span class="sy0">,</span> <span class="nu0">0.25</span><span class="sy0">,</span> Transitions<span class="sy0">.</span>EASE_OUT<span class="br0">&#41;</span><span class="sy0">;</span>
			<span class="kw1">this</span><span class="sy0">.</span>tween<span class="sy0">.</span>animate<span class="br0">&#40;</span><span class="st0">&quot;x&quot;</span><span class="sy0">,</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span>
			<span class="kw1">this</span><span class="sy0">.</span>tween<span class="sy0">.</span>onUpdate = tween_onUpdate<span class="sy0">;</span>
			<span class="kw1">this</span><span class="sy0">.</span>tween<span class="sy0">.</span>onComplete = tween_onComplete<span class="sy0">;</span>
			Starling<span class="sy0">.</span>juggler<span class="sy0">.</span><span class="kw7">add</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="sy0">.</span>tween<span class="br0">&#41;</span><span class="sy0">;</span>
		<span class="br0">&#125;</span>
&nbsp;
		<span class="kw1">protected</span> <span class="kw3">function</span> tween_onUpdate<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw1">void</span>
		<span class="br0">&#123;</span>
			<span class="co1">//position the old screen relative to the new screen</span>
			<span class="kw2">var</span> newScreen<span class="sy0">:</span><a href="http://www.google.com/search?q=displayobject%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:displayobject.html"><span class="kw5">DisplayObject</span></a> = <a href="http://www.google.com/search?q=displayobject%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:displayobject.html"><span class="kw5">DisplayObject</span></a><span class="br0">&#40;</span><span class="kw1">this</span><span class="sy0">.</span>tween<span class="sy0">.</span><span class="kw7">target</span><span class="br0">&#41;</span><span class="sy0">;</span>
			<span class="kw1">this</span><span class="sy0">.</span>savedOldScreen<span class="sy0">.</span><span class="kw7">x</span> = newScreen<span class="sy0">.</span><span class="kw7">x</span> <span class="sy0">-</span> <span class="kw1">this</span><span class="sy0">.</span>navigator<span class="sy0">.</span><span class="kw7">width</span><span class="sy0">;</span>
		<span class="br0">&#125;</span>
&nbsp;
		<span class="kw1">protected</span> <span class="kw3">function</span> tween_onComplete<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw1">void</span>
		<span class="br0">&#123;</span>
			<span class="co1">//we don't need to save these</span>
			<span class="kw1">this</span><span class="sy0">.</span>tween = <span class="kw1">null</span><span class="sy0">;</span>
			<span class="kw1">this</span><span class="sy0">.</span>savedOldScreen = <span class="kw1">null</span><span class="sy0">;</span>
&nbsp;
			<span class="kw2">var</span> completeCallback<span class="sy0">:</span><a href="http://www.google.com/search?q=function%20inurl:http://livedocs.adobe.com/flex/201/langref/%20inurl:function.html"><span class="kw5">Function</span></a> = <span class="kw1">this</span><span class="sy0">.</span>savedCompleteCallback<span class="sy0">;</span>
			<span class="kw1">this</span><span class="sy0">.</span>savedCompleteCallback = <span class="kw1">null</span><span class="sy0">;</span>
&nbsp;
			<span class="co1">//done!</span>
			completeCallback<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

<p>
See the inline comments in the code above for complete details.
</p>

</div>
<!-- EDIT4 SECTION "A Simple Transition Manager" [2538-5691] -->
<h2 class="sectionedit5" id="optimizing_transitions">Optimizing Transitions</h2>
<div class="level2">

<p>
Transition animations between screens help give the user more context. However, the creation of a new screen can be expensive enough to make the runtime skip a transition completely due to dropped frames. Often, by strategically choreographing a screen&#039;s initialization code to spread it out over time, you can improve the performance of screen creation to preserve the transition animation.
</p>

<p>
If possible, try to limit the number of new objects you create in <code>initialize()</code>, and take out any code that does things that aren&#039;t immediately needed when the screen is first displayed. Keep the code in <code>initialize()</code> limited to what must be displayed during the transition. You can listen for <code><a href="http://feathersui.com/documentation/feathers/events/FeathersEventType.html#TRANSITION_COMPLETE" class="urlextern" title="http://feathersui.com/documentation/feathers/events/FeathersEventType.html#TRANSITION_COMPLETE"  rel="nofollow">FeathersEventType.TRANSITION_COMPLETE</a></code> on the screen&#039;s <code><a href="http://feathersui.com/documentation/feathers/controls/IScreen.html#owner" class="urlextern" title="http://feathersui.com/documentation/feathers/controls/IScreen.html#owner"  rel="nofollow">owner</a></code> (the <code>ScreenNavigator</code>) to know when the transition has completed so that you can finish your initialization.
</p>

<p>
Some examples of things to avoid in <code>initialize()</code>:
</p>
<ul>
<li class="level1"><div class="li"> Don&#039;t <code>flatten()</code> anything yet. Starling won&#039;t actually handle the request to flatten a <code>Sprite</code> until the next time that its <code>render()</code> function is called. The transition starts before that, so the expensive processing of flattening will happen in the middle of the transition, which will affect the frame rate. Wait until after the transition to flatten things.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Don&#039;t upload any new textures to the GPU. Ideally, you&#039;ll be using a texture atlas, and your <code>SubTexture</code> objects needed by the screen will already be created with calls to <code>atlas.getTexture()</code> before the screen is initialized.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Don&#039;t create display objects that don&#039;t need to be visible immediately during the transition. If something isn&#039;t vitally important, you should consider creating it after the transition. For instance, you may have all sorts of powerups, enemies, and terrain in your game&#039;s level, but if some of them are not on screen during the transition, consider creating those objects later.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Any long-running code that generates data or does some non-visual calculations can wait too, if its results don&#039;t matter during the transition.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Don&#039;t access the file system during initialization of a screen. If you&#039;re using shared objects or files to store settings and stuff, load those values when the app first starts up or at some other time before you need the screen to transition in.</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> Avoid creating many temporary objects that will be quickly garbage collected. Many functions like <code>push()</code>, <code>unshift()</code>, and <code>splice()</code> from the <code>Array</code> class have <code>rest</code> arguments. Every time one of these functions is called, a new temporary <code>Array</code> will be allocated and quickly deallocated. Garbage collection running during a transition can result in lost frames, especially on slower devices.</div>
</li>
</ul>

<p>
Chances are that all the initialization will still take just as long to complete, but you&#039;ll be spreading it out to strategic times when the user won&#039;t notice that all that work is happening. Some animations in between help make the app look more responsive and they naturally make the user pause for a moment as their brain switches context from watching the content transition in to interacting with it.
</p>

<p>
For more tutorials, return to the <a href="/feathers/start" class="wikilink1" title="feathers:start">Feathers Documentation</a>.
</p>

</div>
<!-- EDIT5 SECTION "Optimizing Transitions" [5692-] -->